<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html lang="en" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html lang="en" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en" class="no-js"> <!--<![endif]-->

<head>

<!--
    ===========
    GLOBAL META
    ===========
-->

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!--
    ==================
    PAGE-SPECIFIC META
    ==================
-->

    <title>CFPB Chart Builder Demo Page</title>
    <meta name="description" content="A test page for Capital Framework components.">

<!--
    ======
    STYLES
    ======
    The number of stylesheets here must be kept to a minimum.
    Unless adding a significant amount of CSS that is specific to a single page
    or section of the site, all new styles should be added to src/static/css/app.less.
-->

<!--[if lt IE 9]>      <link rel="stylesheet" href="/static/css/main.ie.min.css"> <![endif]-->
<!--[if gt IE 8]><!--> <link rel="stylesheet" href="/static/css/main.min.css"> <!--<![endif]-->

<!--
    ============
    HEAD SCRIPTS
    ============
    The following scripts must be included in the head. DO NOT ADD ANY MORE.
    All other scripts should go before the closing body tag.
    If you come across a script that makes a convincing case to be included in
    the head, then file an issue or PR to discuss including it.
-->

<!--[if lt IE 9]>
    <script src="/static/vendor/html5shiv/html5shiv-printshiv.min.js"></script>
<![endif]-->

    <script>
        // Confirm availability of JS and remove no-js class from html
        var docElement = document.documentElement;
        docElement.className = docElement.className.replace(/(^|\s)no-js(\s|$)/, '$1$2');
    </script>

</head>

<body>

<!--
    =================
    Begin page source
    =================
-->

<header class="wrapper wrapper__match-content" role="banner">
    <div class="block block__sub">
        <h1>Capital Framework demo page</h1>
    </div>
</header>

<main class="content" id="main" role="main">
    <div class="content_bar"></div>
    <div class="content_wrapper">
        <div class="content_main">
            <h1>Some Sample CCT Charts</h1>
            <h2>Basic Demo Charts</h2>
            <ul>
              <li><a href="index.html">View basic demo charts</a></li>
            </ul>

            <h2>View all charts by subset</h2>
            <ul>
              <li>Auto Loans</li>
              <ul>
                <li><a href="index.html?set=income&market=AUT">Income Level</a></li>
                <li><a href="index.html?set=age&market=AUT">Age Group</a></li>
                <li><a href="index.html?set=score&market=AUT">Credit Score</a></li>
              </ul>
              <li>Credit Cards</li>
              <ul>
                <li><a href="index.html?set=income&market=CRC">Income Level</a></li>
                <li><a href="index.html?set=age&market=CRC">Age Group</a></li>
                <li><a href="index.html?set=score&market=CRC">Credit Score</a></li>
              </ul>
              <li>Mortgages</li>
              <ul>
                <li><a href="index.html?set=income&market=MTG">Income Level</a></li>
                <li><a href="index.html?set=age&market=MTG">Age Group</a></li>
                <li><a href="index.html?set=score&market=MTG">Credit Score</a></li>
              </ul>
              <li>Student Loans</li>
              <ul>
                <li><a href="index.html?set=income&market=STU">Income Level</a></li>
                <li><a href="index.html?set=age&market=STU">Age Group</a></li>
                <li><a href="index.html?set=score&market=STU">Credit Score</a></li>
              </ul>
            </ul>

            <div id="demo-area">
              <h2>Random samples</h2>


              <div class="cfpb-chart"
                   data-chart-type="line"
                   data-chart-title="Number of loans originated"
                   data-chart-color="blue"
                   data-chart-description="This is the chart description."
                   data-chart-source="consumer-credit-trends/auto-loans/num_data_AUT.csv">
                   This is the chart description.
              </div>

              <hr>

              <div class="cfpb-chart"
                   data-chart-type="bar"
                   data-chart-title="Number of loans originated"
                   data-chart-color="teal"
                   data-chart-description="This is the chart description."
                   data-chart-metadata="Number of Loans"
                   data-chart-source="consumer-credit-trends/auto-loans/yoy_data_all_AUT.csv">
                   This is the chart description.
              </div>

              <hr>

              <div class="cfpb-chart"
                   data-chart-type="line"
                   data-chart-title="Volume of loans originated"
                   data-chart-color="green"
                   data-chart-description="This is the chart description."
                   data-chart-source="consumer-credit-trends/auto-loans/vol_data_AUT.csv">
                   This is the chart description.
              </div>

              <hr>

              <div class="cfpb-chart"
                   data-chart-type="tile_map"
                   data-chart-title="Map about something"
                   data-chart-color="navy"
                   data-chart-description="This is the chart description."
                   data-chart-source="consumer-credit-trends/auto-loans/map_data_AUT.csv">
                   This is the chart description.
              </div>

              <hr>

              <div class="cfpb-chart"
                   data-chart-type="bar"
                   data-chart-title="Volume of loans originated"
                   data-chart-color="blue"
                   data-chart-description="This is the chart description."
                   data-chart-metadata="Dollar Volume"
                   data-chart-source="consumer-credit-trends/auto-loans/yoy_data_all_AUT.csv">
                   This is the chart description.
              </div>

              <hr>

              <div class="cfpb-chart"
                   data-chart-type="line"
                   data-chart-title="Deep subprime (credit scores below 580)"
                   data-chart-color="green"
                   data-chart-description="This is the chart description."
                   data-chart-metadata="Deep subprime"
                   data-chart-source="consumer-credit-trends/auto-loans/volume_data_Score_Level_AUT.csv">
                   This is the chart description.
              </div>

              <hr>

              <div class="cfpb-chart"
                   data-chart-type="line"
                   data-chart-title="Subprime (credit scores 580 - 619)"
                   data-chart-color="teal"
                   data-chart-description="This is the chart description."
                   data-chart-metadata="Subprime"
                   data-chart-source="consumer-credit-trends/auto-loans/volume_data_Score_Level_AUT.csv">
                   This is the chart description.
              </div>

              <hr>

              <div class="cfpb-chart"
                   data-chart-type="tile_map"
                   data-chart-title="This is the tile map title"
                   data-chart-color="navy"
                   data-chart-description="This is the chart description."
                   data-chart-source="consumer-credit-trends/mortgages/map_data_MTG.csv">
                   This is the chart description.
              </div>

              <hr>

              <div class="cfpb-chart"
                   data-chart-type="line"
                   data-chart-title="High income (relative income 120% or above)"
                   data-chart-color="blue"
                   data-chart-description="This is the chart description."
                   data-chart-metadata="High"
                   data-chart-source="consumer-credit-trends/mortgages/volume_data_Income_Level_MTG.csv">
                   This is the chart description.
              </div>

              <hr>

              <div class="cfpb-chart"
                   data-chart-type="bar"
                   data-chart-title="Deep subprime (credit scores below 580)"
                   data-chart-color="green"
                   data-chart-description="This is the chart description."
                   data-chart-metadata="Deep subprime"
                   data-chart-source="consumer-credit-trends/mortgages/yoy_data_Score_Level_MTG.csv">
                   This is the chart description.
              </div>

              <hr>

              <div class="cfpb-chart"
                   data-chart-type="bar"
                   data-chart-title="Subprime"
                   data-chart-color="green"
                   data-chart-description="This is the chart description."
                   data-chart-metadata="Subprime"
                   data-chart-source="consumer-credit-trends/mortgages/yoy_data_Score_Level_MTG.csv">
                   This is the chart description.
              </div>
            </div>
        </div><!-- END .content_main -->
    </div>
</main>

<footer role="contentinfo">
    <!-- Footer stuff -->
</footer>

<!--
    ============
    BODY SCRIPTS
    ============
    The number of scripts here must be kept to a minimum.
    Unless adding a significant amount of JS that is specific to a single page
    or section of the site, all custom JS should be added to src/static/js/index.js.
-->

<script>
// This script generates the charts necessary to QA

function getURLValue( name ) {
    var url = window.location.href;
    name = name.replace(/[\[\]]/g, '\\$&' );
    var regex = new RegExp( '[?&]' + name + '(=([^&#]*)|&|#|$)' );
    var arr = regex.exec( url );
    if ( !arr ) {
      return null;
    }

    return decodeURIComponent( arr[2].replace(/\+/g, ' ' ) );
}

function appendElement( tagname, text ) {

  var elem = document.createElement( tagname );
  var node = document.createTextNode( text );

  elem.appendChild( node );

  demoArea.appendChild( elem )

}

var sample = document.querySelectorAll( '.cfpb-chart' )[0];
var set = getURLValue( 'set' );
var market = getURLValue( 'market' );
var urls = {
  age: 'Age_Group',
  income: 'Income_Level',
  score: 'Score_Level'
}
var sourceFolders = {
  AUT: 'auto-loans/',
  CRC: 'credit-cards/',
  MTG: 'mortgages/',
  STU: 'student-loans/'
}
var sets = {
  age: [ 'Younger than 30', '30-44', '45-64', '65 and older' ],
  income: [ 'Low', 'Moderate', 'Middle', 'High'],
  score: [ 'Deep subprime', 'Subprime', 'Near-prime', 'Prime', 'Super-prime' ]
}

if ( market && set && sets.hasOwnProperty( set ) ) {
  var demoArea = document.getElementById( 'demo-area' );
  demoArea.innerHTML = '';

  appendElement( 'h1', 'Market: ' + market + ', Set: ' + set );

  // generate line (volume) charts
  for ( var x = 0; x < sets[set].length; x++ ) {
    var elem = sample.cloneNode( false );

    // update source
    var source = 'consumer-credit-trends/' + sourceFolders[market];
    source += 'volume_data_' + urls[set] + '_' + market + '.csv';
    elem.setAttribute( 'data-chart-source', source );

    // update metadata
    elem.setAttribute( 'data-chart-metadata', sets[set][x] );

    appendElement( 'h2', sets[set][x] );
    demoArea.appendChild( elem );
  }

  // generate bar (year over year) charts
  for ( var x = 0; x < sets[set].length; x++ ) {
    var elem = sample.cloneNode( false );

    // update to chart type
    elem.setAttribute( 'data-chart-type', 'bar' );

    // update source
    var source = 'consumer-credit-trends/' + sourceFolders[market];
    source += 'yoy_data_' + urls[set] + '_' + market + '.csv';
    elem.setAttribute( 'data-chart-source', source );

    // update metadata
    elem.setAttribute( 'data-chart-metadata', sets[set][x] );

    appendElement( 'h2', sets[set][x] );
    demoArea.appendChild( elem );
  }

}


</script>

<script type="text/javascript" src="./test-runner.js"></script>

<script type="text/javascript" src="/static/js/cfpb-chart-builder.min.js"></script>

</body>
